<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TrainingLab - Athlete Dashboard</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      :root {
        /* Cycling-appropriate color scheme */
        --primary-blue: #2563eb;
        --secondary-blue: #1e40af;
        --accent-orange: #f97316;
        --success-green: #10b981;
        --warning-yellow: #f59e0b;
        --danger-red: #ef4444;
        --gray-50: #f9fafb;
        --gray-100: #f3f4f6;
        --gray-200: #e5e7eb;
        --gray-300: #d1d5db;
        --gray-600: #4b5563;
        --gray-700: #374151;
        --gray-800: #1f2937;
        --gray-900: #111827;

        /* Power zones */
        --zone1: #9ca3af;
        --zone2: #3b82f6;
        --zone3: #10b981;
        --zone4: #f59e0b;
        --zone5: #f97316;
        --zone6: #ef4444;
        --zone7: #7c3aed;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          'Inter',
          -apple-system,
          BlinkMacSystemFont,
          'Segoe UI',
          system-ui,
          sans-serif;
        background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
        color: var(--gray-900);
        line-height: 1.6;
        min-height: 100vh;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 20px;
      }

      /* Header */
      .header {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid var(--gray-200);
        padding: 1rem 0;
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .header-content {
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--primary-blue);
      }

      .logo i {
        font-size: 2rem;
      }

      .user-info {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .profile-dropdown {
        position: relative;
      }

      .user-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(
          45deg,
          var(--primary-blue),
          var(--accent-orange)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        border: none;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .user-avatar:hover {
        transform: scale(1.05);
      }

      .profile-chevron {
        font-size: 0.75rem;
        margin-left: 0.25rem;
        transition: transform 0.2s ease;
      }

      .profile-dropdown.active .profile-chevron {
        transform: rotate(180deg);
      }

      .profile-menu {
        position: absolute;
        top: calc(100% + 8px);
        right: 0;
        background: white;
        border-radius: 12px;
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.12);
        border: 1px solid var(--gray-200);
        min-width: 280px;
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-8px);
        transition: all 0.2s ease;
      }

      .profile-menu.show {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      .profile-menu-header {
        padding: 1rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .profile-menu-avatar {
        width: 48px;
        height: 48px;
        background: linear-gradient(
          45deg,
          var(--primary-blue),
          var(--accent-orange)
        );
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        font-size: 1.125rem;
      }

      .profile-menu-info {
        flex: 1;
      }

      .profile-menu-name {
        font-weight: 600;
        font-size: 0.875rem;
        color: var(--gray-900);
        margin-bottom: 0.125rem;
      }

      .profile-menu-email {
        font-size: 0.75rem;
        color: var(--gray-600);
      }

      .profile-menu-divider {
        height: 1px;
        background: var(--gray-200);
        margin: 0.5rem 0;
      }

      .profile-menu-item {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.75rem 1rem;
        color: var(--gray-700);
        text-decoration: none;
        font-size: 0.875rem;
        font-weight: 500;
        transition: background-color 0.2s ease;
      }

      .profile-menu-item:hover {
        background: var(--gray-100);
        color: var(--gray-900);
      }

      .profile-menu-item i {
        width: 16px;
        text-align: center;
        color: var(--gray-600);
      }

      /* Metrics Bar */
      .metrics-bar {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        padding: 1.5rem 0;
        border-bottom: 1px solid var(--gray-200);
        position: sticky;
        top: 73px;
        z-index: 99;
      }

      .metrics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 1rem;
      }

      .metric-card {
        background: white;
        border-radius: 12px;
        padding: 1.25rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        transition: all 0.2s ease;
        border: 1px solid var(--gray-200);
      }

      .metric-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
      }

      .metric-header {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 0.75rem;
      }

      .metric-icon {
        width: 32px;
        height: 32px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        color: white;
      }

      .metric-title {
        font-size: 0.875rem;
        color: var(--gray-600);
        font-weight: 500;
      }

      .metric-value {
        font-size: 1.75rem;
        font-weight: 700;
        color: var(--gray-900);
        margin-bottom: 0.25rem;
      }

      .metric-change {
        font-size: 0.75rem;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 0.25rem;
      }

      .metric-change.positive {
        color: var(--success-green);
      }

      .metric-change.negative {
        color: var(--danger-red);
      }

      .metric-change.neutral {
        color: var(--gray-600);
      }

      /* Main Content */
      .main-content {
        padding: 2rem 0;
      }

      /* Tabs */
      .tabs {
        display: flex;
        gap: 2px;
        margin-bottom: 2rem;
        background: white;
        border-radius: 12px;
        padding: 4px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      }

      .tab-button {
        flex: 1;
        padding: 1rem 1.5rem;
        border: none;
        background: transparent;
        color: var(--gray-600);
        font-weight: 500;
        cursor: pointer;
        border-radius: 8px;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }

      .tab-button.active {
        background: var(--primary-blue);
        color: white;
        box-shadow: 0 2px 4px rgba(37, 99, 235, 0.2);
      }

      .tab-button:not(.active):hover {
        background: var(--gray-100);
        color: var(--gray-900);
      }

      /* Tab Content */
      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      /* Athlete Tab */
      .athlete-grid {
        display: grid;
        grid-template-columns: 1fr 2fr;
        gap: 2rem;
      }

      .metrics-form {
        background: white;
        border-radius: 16px;
        padding: 2rem;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
        height: fit-content;
      }

      .form-title {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
        color: var(--gray-900);
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-label {
        display: block;
        font-size: 0.875rem;
        font-weight: 500;
        color: var(--gray-700);
        margin-bottom: 0.5rem;
      }

      .form-input {
        width: 100%;
        padding: 0.75rem 1rem;
        border: 1px solid var(--gray-300);
        border-radius: 8px;
        font-size: 1rem;
        transition: all 0.2s ease;
      }

      .form-input:focus {
        outline: none;
        border-color: var(--primary-blue);
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
      }

      .btn {
        padding: 0.75rem 1.5rem;
        border: none;
        border-radius: 8px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }

      .btn-primary {
        background: var(--primary-blue);
        color: white;
      }

      .btn-primary:hover {
        background: var(--secondary-blue);
      }

      .charts-container {
        display: grid;
        gap: 2rem;
      }

      .chart-card {
        background: white;
        border-radius: 16px;
        padding: 2rem;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
      }

      .chart-title {
        font-size: 1.125rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: var(--gray-900);
      }

      .chart-placeholder {
        height: 250px;
        background: linear-gradient(
          135deg,
          var(--gray-100) 0%,
          var(--gray-200) 100%
        );
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--gray-600);
        font-style: italic;
      }

      /* Training Tab */
      .training-controls {
        display: flex;
        gap: 1rem;
        margin-bottom: 2rem;
        flex-wrap: wrap;
      }

      .filter-group {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .filter-select {
        padding: 0.5rem 1rem;
        border: 1px solid var(--gray-300);
        border-radius: 8px;
        background: white;
      }

      .sessions-container {
        background: white;
        border-radius: 16px;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
        overflow: hidden;
      }

      .sessions-header {
        padding: 1.5rem 2rem;
        border-bottom: 1px solid var(--gray-200);
        font-weight: 600;
        color: var(--gray-900);
      }

      .session-item {
        padding: 1.5rem 2rem;
        border-bottom: 1px solid var(--gray-200);
        display: grid;
        grid-template-columns: 120px 1fr 80px 80px 80px 80px 120px;
        gap: 1rem;
        align-items: center;
        transition: background 0.2s ease;
      }

      .session-item:hover {
        background: var(--gray-50);
      }

      .session-date {
        font-weight: 500;
        color: var(--gray-900);
      }

      .session-type {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .type-badge {
        padding: 0.25rem 0.75rem;
        border-radius: 16px;
        font-size: 0.75rem;
        font-weight: 500;
        color: white;
      }

      .type-endurance {
        background: var(--zone2);
      }

      .type-threshold {
        background: var(--zone4);
      }

      .type-vo2max {
        background: var(--zone5);
      }

      .type-recovery {
        background: var(--zone1);
      }

      .integration-status {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .status-indicator {
        width: 8px;
        height: 8px;
        border-radius: 50%;
      }

      .status-synced {
        background: var(--success-green);
      }

      .status-pending {
        background: var(--warning-yellow);
      }

      /* Performance Tab */
      .performance-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        margin-bottom: 2rem;
      }

      .power-curve {
        grid-column: 1 / -1;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .header-content {
          flex-direction: column;
          gap: 1rem;
          text-align: center;
        }

        .metrics-grid {
          grid-template-columns: repeat(2, 1fr);
          gap: 0.75rem;
        }

        .metric-card {
          padding: 1rem;
        }

        .metric-value {
          font-size: 1.5rem;
        }

        .tabs {
          flex-direction: column;
          gap: 1px;
        }

        .tab-button {
          padding: 1rem;
        }

        .athlete-grid {
          grid-template-columns: 1fr;
          gap: 1.5rem;
        }

        .training-controls {
          flex-direction: column;
          align-items: stretch;
        }

        .session-item {
          grid-template-columns: 1fr;
          gap: 0.75rem;
          text-align: left;
        }

        .session-item > div {
          display: flex;
          justify-content: space-between;
          align-items: center;
        }

        .performance-grid {
          grid-template-columns: 1fr;
        }

        .metrics-bar {
          top: 57px;
        }
      }

      @media (max-width: 480px) {
        .container {
          padding: 0 15px;
        }

        .metrics-grid {
          grid-template-columns: 1fr;
        }

        .metric-card {
          text-align: center;
        }

        .main-content {
          padding: 1.5rem 0;
        }

        .metrics-form,
        .chart-card,
        .sessions-container {
          padding: 1.5rem;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="container">
        <div class="header-content">
          <div class="logo">
            <i class="fas fa-bicycle"></i>
            <span>TrainingLab</span>
          </div>
          <div class="user-info">
            <span class="user-name">Welcome back, Alex</span>
            <!-- Quick Settings -->
            <div id="quickSettingsContainer"></div>
            <div class="profile-dropdown">
              <button
                class="user-avatar"
                id="profileMenuBtn"
                title="Profile Menu"
              >
                AR
                <i class="fas fa-chevron-down profile-chevron"></i>
              </button>
              <div class="profile-menu" id="profileMenu">
                <div class="profile-menu-header">
                  <div class="profile-menu-avatar">AR</div>
                  <div class="profile-menu-info">
                    <div class="profile-menu-name">Alex Thompson</div>
                    <div class="profile-menu-email">demo@traininglab.com</div>
                  </div>
                </div>
                <div class="profile-menu-divider"></div>
                <a href="#" class="profile-menu-item" id="manageProfileBtn">
                  <i class="fas fa-user"></i>
                  <span>Manage Profile</span>
                </a>
                <a href="#" class="profile-menu-item" id="preferencesBtn">
                  <i class="fas fa-cog"></i>
                  <span>Preferences</span>
                </a>
                <div class="profile-menu-divider"></div>
                <a href="#" class="profile-menu-item" id="signOutBtn">
                  <i class="fas fa-sign-out-alt"></i>
                  <span>Sign Out</span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Metrics Bar -->
    <div class="metrics-bar">
      <div class="container">
        <div class="metrics-grid">
          <div class="metric-card">
            <div class="metric-header">
              <div class="metric-icon" style="background: var(--accent-orange)">
                <i class="fas fa-bolt"></i>
              </div>
              <div class="metric-title">Current FTP</div>
            </div>
            <div class="metric-value">285W</div>
            <div class="metric-change positive">
              <i class="fas fa-arrow-up"></i>
              +5W from last test
            </div>
          </div>

          <div class="metric-card">
            <div class="metric-header">
              <div class="metric-icon" style="background: var(--primary-blue)">
                <i class="fas fa-weight"></i>
              </div>
              <div class="metric-title">Weight</div>
            </div>
            <div class="metric-value">72.5kg</div>
            <div class="metric-change negative">
              <i class="fas fa-arrow-down"></i>
              -0.3kg this week
            </div>
          </div>

          <div class="metric-card">
            <div class="metric-header">
              <div class="metric-icon" style="background: var(--zone4)">
                <i class="fas fa-chart-line"></i>
              </div>
              <div class="metric-title">Recent TSS</div>
            </div>
            <div class="metric-value">89</div>
            <div class="metric-change neutral">
              <i class="fas fa-minus"></i>
              Yesterday's session
            </div>
          </div>

          <div class="metric-card">
            <div class="metric-header">
              <div class="metric-icon" style="background: var(--success-green)">
                <i class="fas fa-heartbeat"></i>
              </div>
              <div class="metric-title">HRV Score</div>
            </div>
            <div class="metric-value">45</div>
            <div class="metric-change positive">
              <i class="fas fa-arrow-up"></i>
              +3 from yesterday
            </div>
          </div>

          <div class="metric-card">
            <div class="metric-header">
              <div class="metric-icon" style="background: var(--zone5)">
                <i class="fas fa-dumbbell"></i>
              </div>
              <div class="metric-title">Training Load</div>
            </div>
            <div class="metric-value">342</div>
            <div class="metric-change positive">
              <i class="fas fa-arrow-up"></i>
              7-day average
            </div>
          </div>

          <div class="metric-card">
            <div class="metric-header">
              <div class="metric-icon" style="background: var(--zone3)">
                <i class="fas fa-battery-three-quarters"></i>
              </div>
              <div class="metric-title">Recovery Status</div>
            </div>
            <div class="metric-value">Good</div>
            <div class="metric-change positive">
              <i class="fas fa-check"></i>
              Ready to train
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <div class="container">
        <!-- Tabs -->
        <div class="tabs">
          <button class="tab-button active" data-tab="athlete">
            <i class="fas fa-user"></i>
            Athlete
          </button>
          <button class="tab-button" data-tab="training">
            <i class="fas fa-bicycle"></i>
            Training
          </button>
          <button class="tab-button" data-tab="performance">
            <i class="fas fa-chart-bar"></i>
            Performance
          </button>
        </div>

        <!-- Athlete Tab Content -->
        <div class="tab-content active" id="athlete-tab">
          <div class="athlete-grid">
            <div class="metrics-form">
              <h3 class="form-title">Update Metrics</h3>
              <form id="metrics-form">
                <div class="form-group">
                  <label class="form-label" for="weight">Weight (kg)</label>
                  <input
                    type="number"
                    id="weight"
                    class="form-input"
                    step="0.1"
                    placeholder="72.5"
                  />
                </div>
                <div class="form-group">
                  <label class="form-label" for="ftp">FTP (watts)</label>
                  <input
                    type="number"
                    id="ftp"
                    class="form-input"
                    placeholder="285"
                  />
                </div>
                <div class="form-group">
                  <label class="form-label" for="hrv">HRV Score</label>
                  <input
                    type="number"
                    id="hrv"
                    class="form-input"
                    placeholder="45"
                  />
                </div>
                <div class="form-group">
                  <label class="form-label" for="resting-hr"
                    >Resting HR (bpm)</label
                  >
                  <input
                    type="number"
                    id="resting-hr"
                    class="form-input"
                    placeholder="52"
                  />
                </div>
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-save"></i>
                  Update Metrics
                </button>
              </form>
            </div>

            <div class="charts-container">
              <div class="chart-card">
                <h3 class="chart-title">Weight Trend (30 days)</h3>
                <div class="chart-placeholder">
                  Weight tracking chart will be rendered here
                </div>
              </div>

              <div class="chart-card">
                <h3 class="chart-title">FTP Progress</h3>
                <div class="chart-placeholder">
                  FTP progression chart will be rendered here
                </div>
              </div>

              <div class="chart-card">
                <h3 class="chart-title">HRV & Recovery Trends</h3>
                <div class="chart-placeholder">
                  HRV and recovery status chart will be rendered here
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Training Tab Content -->
        <div class="tab-content" id="training-tab">
          <div class="training-controls">
            <div class="filter-group">
              <label>Date Range:</label>
              <select class="filter-select">
                <option>Last 30 days</option>
                <option selected>Last 90 days</option>
                <option>Last 6 months</option>
                <option>This year</option>
              </select>
            </div>
            <div class="filter-group">
              <label>Workout Type:</label>
              <select class="filter-select">
                <option>All Types</option>
                <option>Endurance</option>
                <option>Threshold</option>
                <option>VO2 Max</option>
                <option>Recovery</option>
              </select>
            </div>
            <div class="filter-group">
              <label>Intensity:</label>
              <select class="filter-select">
                <option>All Intensities</option>
                <option>Easy (Zone 1-2)</option>
                <option>Moderate (Zone 3-4)</option>
                <option>Hard (Zone 5+)</option>
              </select>
            </div>
          </div>

          <div class="sessions-container">
            <div class="sessions-header">
              Recent Training Sessions (90 days)
            </div>

            <div class="session-item">
              <div class="session-date">Dec 15, 2024</div>
              <div class="session-type">
                <span class="type-badge type-threshold">Threshold</span>
                Sweet Spot Intervals
              </div>
              <div>75min</div>
              <div>89 TSS</div>
              <div>0.83 IF</div>
              <div>245W NP</div>
              <div class="integration-status">
                <div class="status-indicator status-synced"></div>
                <span>Synced</span>
              </div>
            </div>

            <div class="session-item">
              <div class="session-date">Dec 13, 2024</div>
              <div class="session-type">
                <span class="type-badge type-endurance">Endurance</span>
                Easy Recovery Ride
              </div>
              <div>60min</div>
              <div>42 TSS</div>
              <div>0.55 IF</div>
              <div>165W NP</div>
              <div class="integration-status">
                <div class="status-indicator status-synced"></div>
                <span>Synced</span>
              </div>
            </div>

            <div class="session-item">
              <div class="session-date">Dec 11, 2024</div>
              <div class="session-type">
                <span class="type-badge type-vo2max">VO2 Max</span>
                5x5min @ VO2 Max
              </div>
              <div>90min</div>
              <div>112 TSS</div>
              <div>0.91 IF</div>
              <div>268W NP</div>
              <div class="integration-status">
                <div class="status-indicator status-pending"></div>
                <span>Pending</span>
              </div>
            </div>

            <div class="session-item">
              <div class="session-date">Dec 9, 2024</div>
              <div class="session-type">
                <span class="type-badge type-endurance">Endurance</span>
                Zone 2 Base Building
              </div>
              <div>120min</div>
              <div>85 TSS</div>
              <div>0.62 IF</div>
              <div>185W NP</div>
              <div class="integration-status">
                <div class="status-indicator status-synced"></div>
                <span>Synced</span>
              </div>
            </div>

            <div class="session-item">
              <div class="session-date">Dec 7, 2024</div>
              <div class="session-type">
                <span class="type-badge type-threshold">Threshold</span>
                FTP Test (20min)
              </div>
              <div>60min</div>
              <div>78 TSS</div>
              <div>0.95 IF</div>
              <div>285W NP</div>
              <div class="integration-status">
                <div class="status-indicator status-synced"></div>
                <span>Synced</span>
              </div>
            </div>

            <div class="session-item">
              <div class="session-date">Dec 5, 2024</div>
              <div class="session-type">
                <span class="type-badge type-recovery">Recovery</span>
                Active Recovery Spin
              </div>
              <div>45min</div>
              <div>28 TSS</div>
              <div>0.48 IF</div>
              <div>145W NP</div>
              <div class="integration-status">
                <div class="status-indicator status-synced"></div>
                <span>Synced</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Performance Tab Content -->
        <div class="tab-content" id="performance-tab">
          <div class="performance-grid">
            <div class="chart-card">
              <h3 class="chart-title">Peak Power Tracking</h3>
              <div class="chart-placeholder">
                Peak power chart (5s, 1min, 5min, 20min, 60min) will be rendered
                here
              </div>
            </div>

            <div class="chart-card">
              <h3 class="chart-title">TSS Trends</h3>
              <div class="chart-placeholder">
                Training Stress Score trend chart will be rendered here
              </div>
            </div>

            <div class="chart-card power-curve">
              <h3 class="chart-title">Power Duration Curve</h3>
              <div class="chart-placeholder">
                Power duration curve showing current vs. historical best will be
                rendered here
              </div>
            </div>

            <div class="chart-card">
              <h3 class="chart-title">Training Load vs Performance</h3>
              <div class="chart-placeholder">
                Correlation chart between training load and performance metrics
              </div>
            </div>

            <div class="chart-card">
              <h3 class="chart-title">Performance Management Chart</h3>
              <div class="chart-placeholder">
                CTL (Chronic Training Load), ATL (Acute Training Load), TSB
                (Training Stress Balance) chart
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Profile Management Page -->
    <div id="profilePage" style="display: none"></div>

    <!-- User Profile Model Integration -->
    <script type="module">
      // Import the UserProfileModel, ProfilePage, and QuickSettings
      import { UserProfileModel } from '../src/models/UserProfileModel.js';
      import { ModelFactory } from '../src/models/ModelFactory.js';
      import { ProfilePage } from '../src/components/profile/ProfilePage.js';
      import { QuickSettings } from '../src/components/QuickSettings.js';

      // Global user profile instance
      let userProfile = null;
      let profilePage = null;
      let quickSettings = null;

      // Initialize profile management system
      function initializeProfilePage() {
        const profileContainer = document.getElementById('profilePage');
        if (profileContainer && !profilePage) {
          profilePage = new ProfilePage(profileContainer);
        }
      }

      // Initialize quick settings
      function initializeQuickSettings() {
        const quickSettingsContainer = document.getElementById(
          'quickSettingsContainer'
        );
        if (quickSettingsContainer && !quickSettings) {
          quickSettings = new QuickSettings(quickSettingsContainer);
          // Make it globally accessible for debugging
          window.quickSettings = quickSettings;
        }
      }

      // Show profile management page
      function showProfilePage() {
        const dashboardContent = document.querySelector('.main-content');
        const metricsBar = document.querySelector('.metrics-bar');
        const profileContainer = document.getElementById('profilePage');

        if (dashboardContent) dashboardContent.style.display = 'none';
        if (metricsBar) metricsBar.style.display = 'none';
        if (profileContainer) profileContainer.style.display = 'block';

        // Initialize profile page if not already done
        if (!profilePage) {
          initializeProfilePage();
        }

        // Show profile page
        if (profilePage) {
          profilePage.show();
        }
      }

      // Hide profile management page
      function hideProfilePage() {
        const dashboardContent = document.querySelector('.main-content');
        const metricsBar = document.querySelector('.metrics-bar');
        const profileContainer = document.getElementById('profilePage');

        if (dashboardContent) dashboardContent.style.display = 'block';
        if (metricsBar) metricsBar.style.display = 'block';
        if (profileContainer) profileContainer.style.display = 'none';

        if (profilePage) {
          profilePage.hide();
        }
      }

      // Initialize user profile and dashboard
      async function initializeDashboard() {
        try {
          // Try to load existing profile from localStorage
          const savedProfile = localStorage.getItem('traininglab_profile');

          if (savedProfile) {
            userProfile = UserProfileModel.fromJSON(JSON.parse(savedProfile));
          } else {
            // Create demo profile for first-time users
            userProfile = ModelFactory.createDemoProfile();
            saveProfile();
          }

          // Update dashboard with profile data
          updateDashboardMetrics();
          updateUserInfo();

          // Initialize quick settings
          initializeQuickSettings();

          console.log('Dashboard initialized with profile:', userProfile.name);
        } catch (error) {
          console.error('Error initializing dashboard:', error);
          // Fallback to demo profile
          userProfile = ModelFactory.createDemoProfile();
          updateDashboardMetrics();
          updateUserInfo();

          // Initialize quick settings even if profile loading fails
          initializeQuickSettings();
        }
      }

      // Update dashboard metrics with real data
      function updateDashboardMetrics() {
        if (!userProfile) return;

        const metrics = userProfile.getDashboardMetrics();

        // Update FTP metric
        updateMetricCard(0, {
          value: `${metrics.ftp.value}W`,
          change: metrics.ftp.changeText,
          changeType: metrics.ftp.changeType,
        });

        // Update Weight metric
        updateMetricCard(1, {
          value: `${metrics.weight.value}${metrics.weight.unit}`,
          change: metrics.weight.changeText,
          changeType: metrics.weight.changeType,
        });

        // Update TSS metric
        updateMetricCard(2, {
          value: metrics.tss.value.toString(),
          change: metrics.tss.changeText,
          changeType: metrics.tss.changeType,
        });

        // Update HRV metric
        updateMetricCard(3, {
          value: `${metrics.hrv.value}ms`,
          change: metrics.hrv.changeText,
          changeType: metrics.hrv.changeType,
        });

        // Update Training Load metric
        updateMetricCard(4, {
          value: metrics.trainingLoad.value,
          change: metrics.trainingLoad.changeText,
          changeType: metrics.trainingLoad.changeType,
        });

        // Update Recovery Status metric
        updateMetricCard(5, {
          value: `${metrics.recovery.value}%`,
          change: metrics.recovery.changeText,
          changeType: metrics.recovery.changeType,
        });
      }

      // Update a specific metric card
      function updateMetricCard(index, data) {
        const metricCards = document.querySelectorAll('.metric-card');
        if (index >= metricCards.length) return;

        const card = metricCards[index];
        const valueElement = card.querySelector('.metric-value');
        const changeElement = card.querySelector('.metric-change');

        if (valueElement) valueElement.textContent = data.value;
        if (changeElement) {
          changeElement.textContent = data.change;
          changeElement.className = `metric-change ${data.changeType}`;

          // Update icon based on change type
          const icon = changeElement.querySelector('i');
          if (icon) {
            icon.className = `fas fa-${
              data.changeType === 'positive'
                ? 'arrow-up'
                : data.changeType === 'negative'
                  ? 'arrow-down'
                  : 'minus'
            }`;
          }
        }
      }

      // Update user information in header
      function updateUserInfo() {
        if (!userProfile) return;

        const userNameElement = document.querySelector('.user-name');
        if (userNameElement) {
          userNameElement.textContent = `Welcome back, ${userProfile.name || 'Athlete'}`;
        }

        // Update profile menu info
        const profileMenuName = document.querySelector('.profile-menu-name');
        const profileMenuEmail = document.querySelector('.profile-menu-email');
        const userAvatarButton = document.getElementById('profileMenuBtn');
        const profileMenuAvatar = document.querySelector(
          '.profile-menu-avatar'
        );

        if (profileMenuName) {
          profileMenuName.textContent = userProfile.name || 'Athlete';
        }

        if (profileMenuEmail) {
          profileMenuEmail.textContent = userProfile.email || 'No email set';
        }

        // Update avatar initials
        const initials = (userProfile.name || 'AR')
          .split(' ')
          .map(n => n[0])
          .join('')
          .substring(0, 2)
          .toUpperCase();

        if (userAvatarButton) {
          const textNode = Array.from(userAvatarButton.childNodes).find(
            node => node.nodeType === Node.TEXT_NODE
          );
          if (textNode) {
            textNode.textContent = initials;
          }
        }

        if (profileMenuAvatar) {
          profileMenuAvatar.textContent = initials;
        }

        // Update welcome message or other user-specific content
        const welcomeElement = document.querySelector('.welcome-message');
        if (welcomeElement) {
          welcomeElement.textContent = `Welcome back, ${userProfile.name}!`;
        }
      }

      // Save profile to localStorage
      function saveProfile() {
        if (userProfile) {
          localStorage.setItem(
            'traininglab_profile',
            JSON.stringify(userProfile.toJSON())
          );
        }
      }

      // Update user metrics from form
      function updateUserMetrics(formData) {
        if (!userProfile) return;

        if (formData.weight) {
          userProfile.updateWeight(parseFloat(formData.weight));
        }

        if (formData.ftp) {
          userProfile.updateFTP(
            parseInt(formData.ftp),
            'manual',
            'TrainingLab'
          );
        }

        if (formData.hrv) {
          userProfile.updateHRV(parseInt(formData.hrv));
        }

        // Save updated profile
        saveProfile();

        // Refresh dashboard
        updateDashboardMetrics();
      }

      // Export functions for global access
      window.TrainingLab = {
        userProfile: () => userProfile,
        updateMetrics: updateUserMetrics,
        saveProfile: saveProfile,
        refreshDashboard: updateDashboardMetrics,
      };

      // Expose profile page functions globally
      window.showProfilePage = showProfilePage;
      window.hideProfilePage = hideProfilePage;
      window.profilePage = () => profilePage;

      // Initialize dashboard when DOM is loaded
      document.addEventListener('DOMContentLoaded', initializeDashboard);
    </script>

    <script>
      // Profile dropdown functionality
      document.addEventListener('DOMContentLoaded', function () {
        // Profile dropdown menu
        const profileMenuBtn = document.getElementById('profileMenuBtn');
        const profileMenu = document.getElementById('profileMenu');
        const profileDropdown = document.querySelector('.profile-dropdown');

        if (profileMenuBtn && profileMenu) {
          // Toggle dropdown menu
          profileMenuBtn.addEventListener('click', function (e) {
            e.preventDefault();
            e.stopPropagation();

            const isOpen = profileMenu.classList.contains('show');

            if (isOpen) {
              profileMenu.classList.remove('show');
              profileDropdown.classList.remove('active');
            } else {
              profileMenu.classList.add('show');
              profileDropdown.classList.add('active');
            }
          });

          // Close dropdown when clicking outside
          document.addEventListener('click', function (e) {
            if (!profileDropdown.contains(e.target)) {
              profileMenu.classList.remove('show');
              profileDropdown.classList.remove('active');
            }
          });

          // Handle profile menu actions
          const manageProfileBtn = document.getElementById('manageProfileBtn');
          const preferencesBtn = document.getElementById('preferencesBtn');
          const signOutBtn = document.getElementById('signOutBtn');

          if (manageProfileBtn) {
            manageProfileBtn.addEventListener('click', function (e) {
              e.preventDefault();
              profileMenu.classList.remove('show');
              profileDropdown.classList.remove('active');

              // Show profile management page
              if (window.showProfilePage) {
                window.showProfilePage();
              }
            });
          }

          if (preferencesBtn) {
            preferencesBtn.addEventListener('click', function (e) {
              e.preventDefault();
              profileMenu.classList.remove('show');
              profileDropdown.classList.remove('active');

              // Show profile management page with preferences tab
              if (window.showProfilePage) {
                window.showProfilePage();
                // Switch to preferences tab after a short delay
                setTimeout(() => {
                  if (window.profilePage) {
                    window.profilePage.switchToTab('preferences');
                  }
                }, 100);
              }
            });
          }

          if (signOutBtn) {
            signOutBtn.addEventListener('click', function (e) {
              e.preventDefault();
              profileMenu.classList.remove('show');
              profileDropdown.classList.remove('active');

              // Handle sign out (for now just alert)
              alert('Sign out functionality not implemented yet');
            });
          }
        }
      });

      // Tab functionality
      document.addEventListener('DOMContentLoaded', function () {
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');

        tabButtons.forEach(button => {
          button.addEventListener('click', function () {
            const targetTab = this.getAttribute('data-tab');

            // Remove active class from all buttons and contents
            tabButtons.forEach(btn => btn.classList.remove('active'));
            tabContents.forEach(content => content.classList.remove('active'));

            // Add active class to clicked button and corresponding content
            this.classList.add('active');
            document.getElementById(targetTab + '-tab').classList.add('active');
          });
        });

        // Enhanced form submission handler with profile integration
        const metricsForm = document.getElementById('metrics-form');
        if (metricsForm) {
          metricsForm.addEventListener('submit', function (e) {
            e.preventDefault();

            // Get form data
            const formData = {
              weight: document.getElementById('weight').value,
              ftp: document.getElementById('ftp').value,
              hrv: document.getElementById('hrv').value,
              restingHr: document.getElementById('resting-hr').value,
            };

            // Update user profile
            if (window.TrainingLab && window.TrainingLab.updateMetrics) {
              window.TrainingLab.updateMetrics(formData);
              alert('Metrics updated successfully!');
            } else {
              alert('Profile system not initialized. Please refresh the page.');
            }

            // Clear form
            this.reset();
          });
        }

        // Filter change handlers
        const filterSelects = document.querySelectorAll('.filter-select');
        filterSelects.forEach(select => {
          select.addEventListener('change', function () {
            // In real app, this would filter the training sessions
            console.log('Filter changed:', this.value);
          });
        });

        // Enhanced real-time data updates
        function updateMetrics() {
          if (window.TrainingLab && window.TrainingLab.refreshDashboard) {
            window.TrainingLab.refreshDashboard();
            console.log('Metrics updated from profile data');
          }
        }

        // Update metrics every 5 minutes
        setInterval(updateMetrics, 300000);
      });

      // Responsive navigation helper
      function handleResize() {
        const metricsBar = document.querySelector('.metrics-bar');
        const header = document.querySelector('.header');

        if (window.innerWidth <= 768) {
          metricsBar.style.top = header.offsetHeight + 'px';
        } else {
          metricsBar.style.top = '73px';
        }
      }

      window.addEventListener('resize', handleResize);
      window.addEventListener('load', handleResize);
    </script>
  </body>
</html>
